.container.margin-content
  .text-center
    - if @user == current_user
      %h1= title "Your Profile"
      .upcase.text-muted You are connected with Facebook
    - else
      %h1= title @user.name

  = image_tag @user.image, class: 'avatar avatar--hr', alt: 'Profile picture'
  %hr

  .row.justify-content-center
    .col-auto
      %dl
        %dt Contributions
        %dd= @user.versions.count
    .col-auto
      %dl
        %dt Member since
        %dd= @user.created_at.strftime('%B %Y')

  .row.mb-4
    .col-sm-6.mb-4
      .card
        - if @user.versions.present?
          - if @user == current_user && can?(:create, Version)
            .card-header
              .btn-group
                = link_to 'javascript:void(0)', class: "btn btn-primary dropdown-toggle", data: { toggle: 'dropdown' } do
                  %i.fas.fa-plus-circle.mr-1
                  Add new song
                .dropdown-menu
                  = link_to new_song_path, class: 'dropdown-item' do
                    %i.fas.fa-file-alt.mr-1.fa-fw
                    New blank song
                  %label.dropdown-item{ for: 'version_import' }
                    %i.fas.fa-file-upload.mr-1.fa-fw
                    Upload ChordPro, OnSong, file...

          .card-body
            %ul.card-list
              - @user.versions.each do |version|
                %li.card-list-item
                  = link_to song_version_path(version.song, version), class: "card-list-link" do
                    - if version.lang
                      %i.card-list-item__icon{class: "flag-#{version.lang}"}

                    .card-list-item__title= version.title

                    - if version.author
                      .card-list-item__subtitle= version.author

        - elsif @user == current_user
          .card-body
            %p You have not added any songs to the database yet.
            = link_to new_song_path, class: 'btn btn-primary' do
              %i.fas.fa-plus-circle.mr-1
              Add your first song

        - else
          .card-body
            #{@user} has not added any songs to the
            database yet.

    .col-sm-6.mb-4
      .card
        - if @user.setlists.present?
          - if @user == current_user && can?(:create, Setlist)
            .card-header
              .btn-group
                = link_to new_setlist_path, class: "btn btn-primary" do
                  %i.fas.fa-plus-circle.mr-1
                  Add new setlist

          .card-body
            %ul.card-list
              - @user.setlists.decorate.each do |setlist|
                %li.card-list-item
                  = link_to setlist, class: "card-list-link" do
                    %i.card-list-item__icon.far.fa-list-alt.fa-fw
                    .card-list-item__title= setlist

                    - if setlist.title.present?
                      .card-list-item__subtitle= setlist.date.strftime('%d %B %Y')

        - elsif @user == current_user
          .card-body
            %p You have not created any setlists yet.
            = link_to new_setlist_path, class: 'btn btn-primary' do
              %i.fas.fa-plus-circle.mr-1
              Add your first setlist

        - else
          .card-body
            #{@user} has not added any setlists yet.

  - if @user == current_user
    .my-4.text-center
      = link_to logout_path, method: :delete, class: 'btn btn-sm btn-outline-secondary' do
        %i.fas.fa-sign-out-alt
        Sign out
